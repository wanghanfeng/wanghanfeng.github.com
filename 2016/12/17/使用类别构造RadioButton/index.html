<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>使用类别构造RadioButton | 王韩峰的博客</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">使用类别构造RadioButton</h1><a id="logo" href="/.">王韩峰的博客</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">使用类别构造RadioButton</h1><div class="post-meta">Dec 17, 2016<span> | </span><span class="category"><a href="/categories/iOS-开发/">iOS 开发</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><h4 id=""><a href="#" class="headerlink" title=" "></a> </h4><p>在iOS中如果要使用类似安卓中的RadioButton，就会发现比较麻烦，因为在iOS中没有自带的RadioButton的官方控件，只能自己实现或者使用第三方库。</p>
<p>先上一张图：<br><img src="/images/photo3.png" alt="Simulator Screen Shot 2016年8月21日 下午9.36.28.png"></p>
<p>就拿上图来举例，上图用到了两个RadioButton了，在每一类里只允许有一个选项，如果用户点击了新的选项，那么以前的选项就失效了，并且高亮选择的是最新的选项。</p>
<p>由于功能比较简单，我选择了自己实现RadioButton,虽然cocoapods上有很多已经造好了的轮子，但是我认为像这种很简单的控件能自己写的尽量还是不要用第三放的为好，闲话不多说了。</p>
<p>RadioButton的实现思路是做一个遍历，每当同一组的RadioButton的状态发生改变之后对所有的button进行一个遍历，把最新点击的button的selected属性更新为YES，把其他的button的selected属性更新为NO。</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">self.timeBtnArr = [[NSMutableArray alloc] initWithCapacity:<span class="number">0</span>]<span class="comment">;</span></div><div class="line">for (int i = <span class="number">1</span><span class="comment">; i&lt;=4; i++) &#123;</span></div><div class="line">        UIButton *<span class="keyword">button </span>= [UIButton <span class="keyword">buttonWithType:UIButtonTypeCustom];</span></div><div class="line">        <span class="keyword">button.tag </span>= <span class="keyword">baseTag </span>+ i<span class="comment">;</span></div><div class="line">        <span class="keyword">button.titleLabel.font </span>= [UIFont systemFontOfSize:<span class="number">9</span>]<span class="comment">;</span></div><div class="line">        [<span class="keyword">button </span>setTitleColor:[UIColor colorFromHexRGB:@<span class="string">"595959"</span>] forState:UIControlStateNormal]<span class="comment">;</span></div><div class="line">        [<span class="keyword">button </span>setTitleColor:[UIColor colorFromHexRGB:@<span class="string">"ed7e2d"</span>] forState:UIControlStateSelected]<span class="comment">;</span></div><div class="line">        <span class="keyword">button.layer.cornerRadius </span>= <span class="number">3</span><span class="comment">;</span></div><div class="line">        <span class="keyword">button.layer.borderWidth </span>= <span class="number">0</span>.<span class="number">5</span><span class="comment">;</span></div><div class="line">        <span class="keyword">button.layer.borderColor </span>= [UIColor colorFromHexRGB:@<span class="string">"595959"</span>].CGColor<span class="comment">;</span></div><div class="line">        <span class="keyword">button.layer.masksToBounds </span>= YES<span class="comment">;</span></div><div class="line">        </div><div class="line">        [<span class="keyword">button </span><span class="keyword">addTarget:self </span>action:@selector(<span class="keyword">btnDidClicked:) </span>forControlEvents:UIControlEventTouchUpInside]<span class="comment">;</span></div><div class="line">        </div><div class="line">        [self.view <span class="keyword">addSubview:button];</span></div><div class="line">        </div><div class="line">        <span class="keyword">switch </span>(i) &#123;</div><div class="line">            case <span class="number">1</span>:</div><div class="line">                [<span class="keyword">button </span>setTitle:@<span class="string">"不限"</span> forState:UIControlStateNormal]<span class="comment">;</span></div><div class="line">                <span class="keyword">button.additionInfo </span>= @<span class="string">""</span><span class="comment">;</span></div><div class="line">                <span class="keyword">break;</span></div><div class="line">            case <span class="number">2</span>:</div><div class="line">                [<span class="keyword">button </span>setTitle:@<span class="string">"十五天内"</span> forState:UIControlStateNormal]<span class="comment">;</span></div><div class="line">                <span class="keyword">button.additionInfo </span>= @<span class="string">"15"</span><span class="comment">;</span></div><div class="line">                <span class="keyword">break;</span></div><div class="line">            case <span class="number">3</span>:</div><div class="line">                [<span class="keyword">button </span>setTitle:@<span class="string">"十天内"</span> forState:UIControlStateNormal]<span class="comment">;</span></div><div class="line">                <span class="keyword">button.additionInfo </span>= @<span class="string">"10"</span><span class="comment">;</span></div><div class="line">                <span class="keyword">break;</span></div><div class="line">            case <span class="number">4</span>:</div><div class="line">                [<span class="keyword">button </span>setTitle:@<span class="string">"五天内"</span> forState:UIControlStateNormal]<span class="comment">;</span></div><div class="line">                <span class="keyword">button.additionInfo </span>= @<span class="string">"5"</span><span class="comment">;</span></div><div class="line">                <span class="keyword">break;</span></div><div class="line"><span class="symbol">            default:</span></div><div class="line">                <span class="keyword">break;</span></div><div class="line">        &#125;</div><div class="line">        [self.timeBtnArr <span class="keyword">addObject:button];</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>用for循环添加了一个具有四个button的RadioButton，以后在_timeBtnArr中对RadioButton的状态进行操作。</p>
<p>看一下触发按钮状态的代码：<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">- (void)<span class="keyword">btnDidClicked:(UIButton </span>*) <span class="keyword">btn&#123;</span></div><div class="line">        for (UIButton *<span class="keyword">button </span>in self.timeBtnArr) &#123;</div><div class="line">            if (<span class="keyword">button.tag </span>== <span class="keyword">btn.tag) </span>&#123;</div><div class="line">                <span class="keyword">button.layer.borderColor </span>= [UIColor colorFromHexRGB:@<span class="string">"ed7e2d"</span>].CGColor<span class="comment">;</span></div><div class="line">                <span class="keyword">button.selected </span>= YES<span class="comment">;</span></div><div class="line">            &#125;</div><div class="line">            else&#123;</div><div class="line">                <span class="keyword">button.layer.borderColor </span>= [UIColor colorFromHexRGB:@<span class="string">"595959"</span>].CGColor<span class="comment">;</span></div><div class="line">                <span class="keyword">button.selected </span>= NO<span class="comment">;</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>每当RadioButton的状态改变时，都会从新更新一下RadioButton中button的状态。</p>
<p>但是，上面这么做跟业务的要求还是有所偏差，因为需要将RadioButton的选择状态保存下来。虽然可以直接将选中状态的title保存下来，但是这样显然会增加数据存储量，而且也不够优雅！所以，我选择将每个button增加一个附加属性，用来设置button所代表的含义。于是，需要为UIButton类增加一个类别，来添加一个additionInfo的属性。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  UIButton+HFExtend.h</span></div><div class="line"><span class="comment">//  xStore</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  Created by apple on 16/8/10.</span></div><div class="line"><span class="comment">//  Copyright © 2016年 apple. All rights reserved.</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UIButton</span> (<span class="title">HFExtend</span>)</span></div><div class="line"></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *additionInfo;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  UIButton+HFExtend.m</span></div><div class="line"><span class="comment">//  xStore</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  Created by apple on 16/8/10.</span></div><div class="line"><span class="comment">//  Copyright © 2016年 apple. All rights reserved.</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"UIButton+HFExtend.h"</span></span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"objc/runtime.h"</span></span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keyword">void</span> *additionInfoKey = &amp;additionInfoKey;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIButton</span> (<span class="title">HFExtend</span>)</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)setAdditionInfo:(<span class="built_in">NSString</span> *)additionInfo&#123;</div><div class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, &amp;additionInfoKey, additionInfo, OBJC_ASSOCIATION_COPY_NONATOMIC);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">NSString</span> *) additionInfo&#123;</div><div class="line"> </div><div class="line">    <span class="keyword">return</span> objc_getAssociatedObject(<span class="keyword">self</span>, &amp;additionInfoKey);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>这样以后就能通过Button的additionInfo的属性来存储附加信息了。以后保存RadioButton的状态直接保存选择button的additionInfo属性即可。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://wanghanfeng.com/2016/12/17/使用类别构造RadioButton/" data-id="cj0dwpe2q000nqou2u2ffr06p" class="article-share-link">分享到</a><div class="tags"><a href="/tags/component/">component</a></div><div class="post-nav"><a href="/2016/12/19/AFNetworking-3-0-POST请求的一个坑/" class="pre">AFNetworking 3.0 POST请求的一个坑</a><a href="/2016/12/16/由于苹果更新开发者程序许可协议导致问题的解决方案/" class="next">由于苹果更新开发者程序许可协议导致问题的解决方案</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://wanghanfeng.com"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Mac操作/">Mac操作</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS-iTunes/">iOS iTunes</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS-开发/">iOS 开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/服务器搭建/">服务器搭建</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法与数据结构/">算法与数据结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机网络/">计算机网络</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/runtime/" style="font-size: 15px;">runtime</a> <a href="/tags/AFNetworking-Objective-C/" style="font-size: 15px;">AFNetworking  Objective-C</a> <a href="/tags/location/" style="font-size: 15px;">location</a> <a href="/tags/网络协议/" style="font-size: 15px;">网络协议</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/数据持久化/" style="font-size: 15px;">数据持久化</a> <a href="/tags/jquery/" style="font-size: 15px;">jquery</a> <a href="/tags/框架/" style="font-size: 15px;">框架</a> <a href="/tags/github/" style="font-size: 15px;">github</a> <a href="/tags/component/" style="font-size: 15px;">component</a> <a href="/tags/Block/" style="font-size: 15px;">Block</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a> <a href="/tags/Mac/" style="font-size: 15px;">Mac</a> <a href="/tags/排序/" style="font-size: 15px;">排序</a> <a href="/tags/PHP/" style="font-size: 15px;">PHP</a> <a href="/tags/算法与数据结构/" style="font-size: 15px;">算法与数据结构</a> <a href="/tags/苹果开发者/" style="font-size: 15px;">苹果开发者</a> <a href="/tags/垃圾回收/" style="font-size: 15px;">垃圾回收</a> <a href="/tags/网络优化/" style="font-size: 15px;">网络优化</a> <a href="/tags/iOS-开发/" style="font-size: 15px;">iOS 开发</a></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">王韩峰的博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>